<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Market Bets - Live</title>
    <link rel="stylesheet" href="https://21ec25b6-1759-48f6-8405-3390f5bcf589.wf-app-prod.cosmic.webflow.services/market-bets/_astro/index.DiRS6Ng1.css">
</head>
<body class="__DARK_MODE_CLASS__">
    <style>astro-island,astro-slot,astro-static-slot{display:contents}</style>

    <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script>

    <astro-island uid="4fW0e" 
        component-url="./TradingApp.js" 
        component-export="default" 
        renderer-url="https://21ec25b6-1759-48f6-8405-3390f5bcf589.wf-app-prod.cosmic.webflow.services/market-bets/_astro/client.B-7Sgvju.js" 
        props="{}" ssr client="only" opts='{"name":"TradingApp","value":"react"}'>
    </astro-island>

    <script>
    async function updatePrices() {
        try {
            const res = await fetch("https://api-yfinance.onrender.com/prix");
            const data = await res.json();
            const els = document.querySelectorAll('.text-xs.font-mono.mt-1');
            
            els.forEach(el => {
                const container = el.closest('div');
                const rowText = container ? container.innerText.toUpperCase() : "";

                for (const [name, info] of Object.entries(data)) {
                    // Nettoyage pour L'OREAL / LOREAL
                    const cleanName = name.replace(/[^A-Z]/g, "");
                    const cleanRow = rowText.replace(/[^A-Z]/g, "");

                    if (cleanRow.includes(cleanName)) {
                        const price = typeof info === 'object' ? info.price : info;
                        if (price > 0) {
                            el.innerText = price.toLocaleString('fr-FR') + " â‚¬";
                            el.style.color = "#39FF14"; // On force le vert pour confirmer
                        }
                    }
                }
            });
        } catch (e) { console.log("Maj..."); }
    }

    const observer = new MutationObserver(updatePrices);
    window.addEventListener('load', () => {
        setTimeout(updatePrices, 2000);
        observer.observe(document.body, { childList: true, subtree: true });
    });
    </script>
</body>
</html>
