<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Market Bets - Live</title>
    <link rel="stylesheet" href="https://21ec25b6-1759-48f6-8405-3390f5bcf589.wf-app-prod.cosmic.webflow.services/market-bets/_astro/index.DiRS6Ng1.css">
</head>
<body class="__DARK_MODE_CLASS__">
    <style>astro-island,astro-slot,astro-static-slot{display:contents}</style>

    <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script>

    <astro-island uid="4fW0e" 
        component-url="./TradingApp.js" 
        component-export="default" 
        renderer-url="https://21ec25b6-1759-48f6-8405-3390f5bcf589.wf-app-prod.cosmic.webflow.services/market-bets/_astro/client.B-7Sgvju.js" 
        props="{}" ssr client="only" opts='{"name":"TradingApp","value":"react"}'>
    </astro-island>

    <script>
    async function refreshPrices() {
        try {
            const response = await fetch("https://api-yfinance.onrender.com/prix");
            const data = await response.json();
            
            // On cible les éléments de prix
            const elements = document.querySelectorAll('.text-xs.font-mono.mt-1');

            elements.forEach(el => {
                const parentText = el.closest('div')?.innerText.toUpperCase() || "";

                for (const [stockName, info] of Object.entries(data)) {
                    // Nettoyage pour matcher L'OREAL
                    const cleanStock = stockName.replace(/[^A-Z]/g, "");
                    const cleanUI = parentText.replace(/[^A-Z]/g, "");

                    if (cleanUI.includes(cleanStock)) {
                        const price = typeof info === 'object' ? info.price : info;
                        if (price > 0) {
                            el.innerText = price.toLocaleString('fr-FR') + " €";
                            el.style.color = "#39FF14"; // Vert néon
                        }
                    }
                }
            });
        } catch (e) { console.warn("Sync en cours..."); }
    }

    // On observe les changements du DOM pour contrer React
    const observer = new MutationObserver(refreshPrices);
    window.addEventListener('load', () => {
        setTimeout(refreshPrices, 2500);
        observer.observe(document.body, { childList: true, subtree: true });
    });
    </script>
    <script src="TradingApp.js"></script>
</body>
</html>
