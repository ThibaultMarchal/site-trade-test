<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <link rel="icon" type="image/png" href="https://thibaults-groovy-site-af44b6.webflow.io/favicon.ico">
    <meta name="viewport" content="width=device-width">
    <meta name="generator" content="Astro v5.13.5">
    <title>Market Bets - Live</title>
    <link rel="stylesheet" href="https://21ec25b6-1759-48f6-8405-3390f5bcf589.wf-app-prod.cosmic.webflow.services/market-bets/_astro/index.DiRS6Ng1.css">
</head>
<body class="__DARK_MODE_CLASS__">
    <style>astro-island,astro-slot,astro-static-slot{display:contents}</style>

    <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script>
    
    <astro-island uid="4fW0e" 
        component-url="https://21ec25b6-1759-48f6-8405-3390f5bcf589.wf-app-prod.cosmic.webflow.services/market-bets/_astro/TradingApp.gEX4uE6q.js" 
        component-export="default" 
        renderer-url="https://21ec25b6-1759-48f6-8405-3390f5bcf589.wf-app-prod.cosmic.webflow.services/market-bets/_astro/client.B-7Sgvju.js" 
        props="{}" ssr client="only" opts='{"name":"TradingApp","value":"react"}'>
    </astro-island>

    <script>
    async function fixPricesEverywhere() {
        try {
            const response = await fetch("https://api-yfinance.onrender.com/prix");
            const data = await response.json();
            
            // On vise la classe que tu as identifiée
            const priceElements = document.querySelectorAll('.text-xs.font-mono.mt-1');

            priceElements.forEach(el => {
                const container = el.closest('div');
                const pageText = container ? container.innerText.toUpperCase() : "";

                for (const [name, info] of Object.entries(data)) {
                    // Nettoyage pour comparer LOREAL et L'OREAL
                    const cleanName = name.replace(/[^A-Z]/g, "");
                    const cleanText = pageText.replace(/[^A-Z]/g, "");

                    if (cleanText.includes(cleanName)) {
                        const realPrice = typeof info === 'object' ? info.price : info;
                        if (realPrice > 0 && realPrice < 5000) {
                            el.innerText = realPrice.toLocaleString('fr-FR') + " €";
                            el.style.color = "#39FF14"; // Vert Flashy
                            el.style.fontWeight = "bold";
                        }
                    }
                }
            });
        } catch (e) {
            console.log("En attente de l'API...");
        }
    }

    // On surveille les changements de React pour ré-appliquer nos prix
    const observer = new MutationObserver(() => {
        fixPricesEverywhere();
    });

    window.addEventListener('load', () => {
        // Premier essai après 2 secondes
        setTimeout(fixPricesEverywhere, 2000);
        // On active le garde du corps (observer)
        observer.observe(document.body, { childList: true, subtree: true });
    });
    </script>
</body>
</html>
